# Implementation Plan - Fixed Cost Form Redesign

**Feature**: Fixed Cost Form Redesign
**Feature Branch**: `010-fixed-cost-form-redesign`
**Goal**: Redesign the fixed cost forms (Monthly, Quarterly, Half-Yearly, Yearly) to match the visual style of the Special Costs form and implement immediate table updates with success notifications.

## Technical Context

### Architecture

- **Frontend**: Vue.js 3.3+, Vuetify 3.3+
- **Styling**: Rounded corners (rounded-xl), specialized toggle switch, card layout
- **Components involved**:
  - `MonthlyCostEditForm.vue`
  - `QuaterlyCostEditForm.vue`
  - `HalfyearlyCostEditForm.vue`
  - `YearlyCostEditForm.vue`
  - `IncomingSelect.vue` (Toggle component)
  - `FixedCostTable.vue`
- **Services**: `services/fixedcosts.js` (API interaction)

### Data Models & Contracts

- **FixedCost Entity**:
  - `id`: number
  - `name`: string
  - `amount`: number
  - `incoming`: boolean (derived from positive/negative amount)
  - `month`/`quarter`/`halfYear`/`dueDate`: number/date

- **API Contracts**:
  - Existing endpoints:
    - `GET /api/costs/monthly`
    - `POST /api/costs/monthly`
    - `GET /api/costs/quarterly`
    - `POST /api/costs/quarterly`
    - `GET /api/costs/halfyearly`
    - `POST /api/costs/halfyearly`
    - `GET /api/costs/yearly`
    - `POST /api/costs/yearly`
  - No contract changes required; focus is on UI and frontend state management.

### Constraints & Unknowns

- **Constraints**:
  - Must use existing `IncomingSelect.vue` component for the toggle.
  - Must use `v-snackbar` for notifications.
  - Must retain existing validation logic.
  - Date picker style remains unchanged.
  - Must close modal immediately on success.

- **Unknowns**:
  - None. All clarifications resolved.

## Constitution Check

### Principles
- [x] **Simplicity**: Reusing existing components (`IncomingSelect`, `v-snackbar`) keeps implementation simple.
- [x] **User Experience**: Visual consistency and immediate feedback directly support UX excellence.
- [x] **Full-Stack Separation**: Changes are purely frontend; backend contracts remain untouched.
- [x] **Test Coverage**: New UI logic and state updates will be covered by component tests.
- [x] **Visual Design**: Aligning with "Fintech Dark Mode" and rounded aesthetics.

### Gates
- [x] **Test Strategy**: Component tests for forms and tables.
- [x] **Design Review**: Matches Special Costs form style (verified by spec).

## Phases

### Phase 0: Outline & Research

1. **Verify `IncomingSelect` Usage**:
   - Check `SpecialCostForm.vue` to see how `IncomingSelect` is implemented and styled.
   - Confirm props and event handling.

2. **Verify `v-snackbar` Global Availability**:
   - Check if a global snackbar exists in `App.vue` or `Layout.vue` or if it needs to be added locally/globally.
   - *Self-correction*: Project usually lacks a global snackbar bus; might need a simple local implementation or a store-based solution.
   - *Research Task*: Determine current pattern for toast notifications in the app.

3. **Verify Table Update Logic**:
   - Check `FixedCosts.vue` (parent view) to see how data is currently refreshed (full reload vs. local splice/push).
   - Plan for optimizing to local update or efficient re-fetch.

### Phase 1: Design & Contracts

1. **Refine Data Model**:
   - Confirm frontend model matches API payload (no changes expected, but verification needed).

2. **API Contracts**:
   - No new endpoints.
   - Confirm existing endpoints return necessary data for immediate table update (usually ID of new item).

### Phase 2: Implementation Strategy

1. **Component Standardization**:
   - Refactor `MonthlyCostEditForm.vue` to use card layout, rounded corners, and `IncomingSelect`.
   - Apply same changes to `QuaterlyCostEditForm.vue`, `HalfyearlyCostEditForm.vue`, `YearlyCostEditForm.vue`.

2. **State Management & Feedback**:
   - Implement `v-snackbar` logic in the parent component (`FixedCosts.vue` or specific tab components).
   - Update `save` methods in forms to emit events with data instead of just reloading.
   - Update parent component to handle save events:
     - Close modal.
     - Show snackbar.
     - Add/Update item in the list (or efficient re-fetch).

3. **Testing**:
   - Update unit tests for each form component to verify presence of specific classes/components.
   - Test "save" event emission.

### Phase 3: Integration

1. **Manual Verification**:
   - Verify visual alignment with Special Costs.
   - Verify success notification appearance.
   - Verify table updates without page reload.

## Tasks

*(To be generated by `/speckit.tasks`)*